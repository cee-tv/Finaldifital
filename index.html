<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Video Player</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.3.8/shaka-player.compiled.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #121212;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: Arial, sans-serif;
        }

        .container {
            width: 100%;
            max-width: 1280px;
            position: relative;
            padding: 1rem;
        }

        .header {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            padding: 1rem;
            background: linear-gradient(to bottom, rgba(0,0,0,0.7), transparent);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 10;
        }

        .menu-button {
            color: white;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.5rem;
        }

        .menu-button:hover {
            color: #1db954;
        }

        .channel-title {
            color: white;
            font-size: 1.25rem;
            font-weight: bold;
        }

        .channel-menu {
            position: absolute;
            top: 5rem;
            left: 1rem;
            background: rgba(0,0,0,0.2);
            backdrop-filter: blur(4px);
            border-radius: 0.5rem;
            width: 16rem;
            padding: 0.5rem;
            z-index: 20;
            display: none;
        }

        .channel-menu.show {
            display: block;
        }

        .search-input {
            width: 90%;
            padding: 0.5rem 0.75rem;
            background: #444444;
            color: white;
            border: none;
            border-radius: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .channel-button {
            width: 100%;
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            color: white;
            background: none;
            border: none;
            cursor: pointer;
            text-align: left;
        }

        .channel-button:hover {
            background: #444444;
        }

        .channel-logo {
            height: 1.5rem;
            margin-right: 0.75rem;
        }

        .video-container {
            width: 100%;
            position: relative;
            border-radius: 0.75rem;
            overflow: hidden;
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25);
        }

        #videoPlayer {
            width: 100%;
            aspect-ratio: 20/9;
            background: black;
        }

        .controls {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 1rem;
            background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .video-container:hover .controls {
            opacity: 1;
        }

        .control-button {
            color: white;
            background: none;
            border: none;
            cursor: pointer;
            padding: 0.5rem;
        }

        .control-button:hover {
            color: #1db954;
        }

        .volume-control {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            margin-left: 1rem;
        }

        #volumeSlider {
            width: 6rem;
        }

        .loading {
            position: absolute;
            inset: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
        }

        .nav-button {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            color: rgba(255,255,255,0.7);
            background: none;
            border: none;
            cursor: pointer;
            font-size: 2rem;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .video-container:hover .nav-button {
            opacity: 1;
        }

        .prev-button {
            left: 1rem;
        }

        .next-button {
            right: 1rem;
        }
    </style>
</head>
<body>
    <div class="container" id="container">
        <div class="header">
            <button class="menu-button" id="menuButton">
                <i class="fas fa-bars"></i>
            </button>
            <h2 class="channel-title" id="channelTitle"></h2>
            <div style="width: 2rem;"></div>
        </div>

        <div class="channel-menu" id="channelMenu">
            <div style="padding: 0.5rem;">
                <input type="text" class="search-input" placeholder="Search channels..." id="searchInput" />
            </div>
            <div id="channelList"></div>
        </div>

        <div class="video-container">
            <video id="videoPlayer"></video>
            
            <button class="nav-button prev-button" id="prevButton">
                <i class="fas fa-chevron-left"></i>
            </button>
            
            <button class="nav-button next-button" id="nextButton">
                <i class="fas fa-chevron-right"></i>
            </button>

            <div class="controls">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div style="display: flex; align-items: center;">
                        <button class="control-button" id="playButton">
                            <i class="fas fa-play"></i>
                        </button>
                        
                        <div class="volume-control">
                            <button class="control-button" id="muteButton">
                                <i class="fas fa-volume-up"></i>
                            </button>
                            <input type="range" id="volumeSlider" min="0" max="1" step="0.1" value="1" />
                        </div>
                    </div>

                    <button class="control-button" id="fullscreenButton">
                        <i class="fas fa-expand"></i>
                    </button>
                </div>
            </div>

            <div class="loading" id="loading" style="display: none;">
                <i class="fas fa-spinner fa-spin"></i>
            </div>
        </div>
    </div>

    <script>
        const channels = [
            {
                name: "TV5 HD",
                logo: "/tv5-logo.png",
                manifestUri: "https://qp-pldt-live-grp-02-prod.akamaized.net/out/u/tv5_hd.mpd",
                keyId: "2615129ef2c846a9bbd43a641c7303ef",
                key: "07c7f996b1734ea288641a68e1cfdc4d",
                type: "dash"
            },
            {
                name: "ABS-CBN",
                logo: "/abs-cbn-logo.png",
                manifestUri: "https://cdn-uw2-prod.tsv2.amagi.tv/linear/amg01006-abs-cbn-abscbn-gma-x7-dash-abscbnono/7c693236-e0c1-40a3-8bd0-bb25e43f5bfc/index.mpd",
                keyId: "c95ed4c44b0b4f7fa1c6ebbbbaab21a1",
                key: "47635b8e885e19f2ccbdff078c207058",
                type: "dash"
            },
            {
                name: "MYX",
                logo: "/myx-logo.png",
                manifestUri: "https://myxnola-abscbn-ono.amagi.tv/index.m3u8",
                type: "hls"
            }
        ];

        let player = null;
        let hlsPlayer = null;
        let currentChannelIndex = 0;

        const video = document.getElementById('videoPlayer');
        const channelTitle = document.getElementById('channelTitle');
        const menuButton = document.getElementById('menuButton');
        const channelMenu = document.getElementById('channelMenu');
        const channelList = document.getElementById('channelList');
        const searchInput = document.getElementById('searchInput');
        const loading = document.getElementById('loading');
        const playButton = document.getElementById('playButton');
        const muteButton = document.getElementById('muteButton');
        const volumeSlider = document.getElementById('volumeSlider');
        const fullscreenButton = document.getElementById('fullscreenButton');
        const prevButton = document.getElementById('prevButton');
        const nextButton = document.getElementById('nextButton');
        const container = document.getElementById('container');

        async function initPlayer() {
            const shaka = window.shaka;
            shaka.polyfill.installAll();

            if (shaka.Player.isBrowserSupported()) {
                player = new shaka.Player(video);
                loadChannel(channels[0], 0);
            }
        }

        async function loadChannel(channel, index) {
            loading.style.display = 'flex';
            
            try {
                if (channel.type === 'hls') {
                    if (player) {
                        await player.unload();
                    }
                    if (!hlsPlayer) {
                        hlsPlayer = new Hls();
                    }
                    hlsPlayer.loadSource(channel.manifestUri);
                    hlsPlayer.attachMedia(video);
                } else {
                    if (hlsPlayer) {
                        hlsPlayer.destroy();
                        hlsPlayer = null;
                    }
                    await player.unload();
                    const clearKeys = {};
                    clearKeys[channel.keyId] = channel.key;
                    await player.configure({
                        drm: {
                            servers: {
                                'org.w3.clearkey': 'https://clearkey-base.herokuapp.com/v1/clearkey'
                            },
                            clearKeys
                        }
                    });
                    await player.load(channel.manifestUri);
                }

                currentChannelIndex = index;
                channelTitle.textContent = channel.name;
                channelMenu.classList.remove('show');
                video.play();
                updatePlayButton();
            } catch (error) {
                console.error('Error loading channel:', error);
            } finally {
                loading.style.display = 'none';
            }
        }

        function updateChannelList(searchTerm = '') {
            channelList.innerHTML = '';
            const filteredChannels = channels.filter(channel => 
                channel.name.toLowerCase().includes(searchTerm.toLowerCase())
            );

            filteredChannels.forEach((channel, index) => {
                const button = document.createElement('button');
                button.className = 'channel-button';
                button.innerHTML = `${channel.name}
                `;
                button.onclick = () => loadChannel(channel, index);
                channelList.appendChild(button);
            });
        }

        function updatePlayButton() {
            playButton.innerHTML = `<i class="fas fa-${video.paused ? 'play' : 'pause'}"></i>`;
        }

        function togglePlay() {
            if (video.paused) {
                video.play();
            } else {
                video.pause();
            }
            updatePlayButton();
        }

        function toggleMute() {
            video.muted = !video.muted;
            muteButton.innerHTML = `<i class="fas fa-volume-${video.muted ? 'mute' : 'up'}"></i>`;
        }

        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                container.requestFullscreen();
                fullscreenButton.innerHTML = '<i class="fas fa-compress"></i>';
            } else {
                document.exitFullscreen();
                fullscreenButton.innerHTML = '<i class="fas fa-expand"></i>';
            }
        }

        menuButton.onclick = () => {
            channelMenu.classList.toggle('show');
            menuButton.innerHTML = `<i class="fas fa-${channelMenu.classList.contains('show') ? 'times' : 'bars'}"></i>`;
        };

        searchInput.oninput = (e) => updateChannelList(e.target.value);
        playButton.onclick = togglePlay;
        muteButton.onclick = toggleMute;
        fullscreenButton.onclick = toggleFullscreen;
        volumeSlider.onchange = (e) => video.volume = e.target.value;

        prevButton.onclick = () => {
            const prevIndex = currentChannelIndex === 0 ? channels.length - 1 : currentChannelIndex - 1;
            loadChannel(channels[prevIndex], prevIndex);
        };

        nextButton.onclick = () => {
            const nextIndex = (currentChannelIndex + 1) % channels.length;
            loadChannel(channels[nextIndex], nextIndex);
        };

        document.addEventListener('DOMContentLoaded', () => {
            updateChannelList();
            initPlayer();
        });
    </script>
</body>
</html></></script></script></body></style></head></html></></>


